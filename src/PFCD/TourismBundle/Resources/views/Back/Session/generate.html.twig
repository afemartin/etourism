{% extends 'PFCDTourismBundle:Back:layout.html.twig' %}

{% form_theme form 'PFCDTourismBundle:Form:fields.html.twig' %}

{% set sectiontab = 'session' %}{% set datepicker = 1 %}

{% block body %}
<h1>{{ 'back.session.generate.title'|trans }}</h1>
<p>{{ 'back.session.generate.subtitle'|trans }}</p>

<form id="session_generator_form" class="form-horizontal" action="{{ path('back_session_generate') }}" method="post" {{ form_enctype(form) }}>
    {{ form_widget(form) }}
    <div class="form-actions">
        <button class="btn btn-success" type="submit"><i class="icon-ok icon-white"></i> {{ 'Generate'|trans }}</button>
        <a class="btn btn-inverse" href="{{ path('back_session_index') }}"><i class="icon-remove icon-white"></i> {{ 'Cancel'|trans }}</a>
    </div>
</form>

<div id="generate_modal" class="modal hide">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">Ã—</button>
        <h3>{{ 'modal.generatesessions.title'|trans }}</h3>
    </div>
    <div class="modal-body">
        <div id="generate_confirmation"></div>
    </div>
    <div class="modal-footer">
        <a class="btn btn-success" onclick="$('#session_generator_form').submit()">{{ 'Generate'|trans }}</a>
        <a data-dismiss="modal" class="btn btn-inverse" onclick="">{{ 'Cancel'|trans }}</a>
    </div>
</div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script type="text/javascript">
    $('#session_generator_form').submit(function() {
        if (!$(this).data('show-confirm')) {
            var sessions = 
            $('#generate_confirmation').html('{{ 'modal.generatesessions.content'|trans|raw }}');
            $('#generate_modal').modal('show');
            return false;
        }
    });
    $('#generate_modal').on('show', function() { $('#session_generator_form').data('show-confirm', true); });
    $('#generate_modal').on('hide', function() { $('#session_generator_form').data('show-confirm', false); });
</script>
{% endblock %}